# ğŸ³ Dockerç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—

## å¿«é€Ÿéƒ¨ç½²ï¼ˆæ¨èï¼‰

### 1. ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨
```bash
# ä½¿ç”¨git
git clone your-repo-url
cd downloader

# æˆ–ç›´æ¥ä¸Šä¼ é¡¹ç›®æ–‡ä»¶
```

### 2. é…ç½®APIå¯†é’¥
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env
```

å¡«å…¥ä½ çš„APIå¯†é’¥ï¼š
```env
RAPIDAPI_KEY=ä½ çš„RapidAPIå¯†é’¥
RAPIDAPI_HOST=APIä¸»æœºåœ°å€
```

### 3. ä¸€é”®éƒ¨ç½²
```bash
# è¿è¡Œéƒ¨ç½²è„šæœ¬
./deploy-docker.sh
```

## æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

### 1. å®‰è£…Docker
```bash
curl -fsSL https://get.docker.com | sh
sudo usermod -aG docker $USER
```

### 2. å®‰è£…Docker Compose
```bash
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
```

### 3. æ„å»ºå’Œå¯åŠ¨
```bash
# æ„å»ºé•œåƒ
docker-compose build

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹çŠ¶æ€
docker-compose ps
```

## æœåŠ¡ç®¡ç†

### å¸¸ç”¨å‘½ä»¤
```bash
# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
docker-compose ps

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs -f

# é‡å¯æœåŠ¡
docker-compose restart

# åœæ­¢æœåŠ¡
docker-compose down

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build
```

### ç›‘æ§å’Œç»´æŠ¤
```bash
# æŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µ
docker stats douyin-downloader

# æ¸…ç†æ— ç”¨é•œåƒ
docker image prune -f

# æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯
docker inspect douyin-downloader
```

## ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–

### 1. åå‘ä»£ç†é…ç½®ï¼ˆNginxï¼‰
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

### 2. SSLè¯ä¹¦ï¼ˆLet's Encryptï¼‰
```bash
# å®‰è£…certbot
sudo apt install certbot python3-certbot-nginx

# ç”³è¯·è¯ä¹¦
sudo certbot --nginx -d your-domain.com
```

### 3. é˜²ç«å¢™é…ç½®
```bash
# å¼€æ”¾ç«¯å£
sudo ufw allow 80
sudo ufw allow 443
sudo ufw allow 3000

# å¯ç”¨é˜²ç«å¢™
sudo ufw enable
```

## æ•…éšœæ’é™¤

### 1. å®¹å™¨å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose logs douyin-downloader

# æ£€æŸ¥é…ç½®
docker-compose config
```

### 2. APIè°ƒç”¨å¤±è´¥
- æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„APIå¯†é’¥
- ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
- æŸ¥çœ‹åº”ç”¨æ—¥å¿—

### 3. ç«¯å£å†²çª
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo netstat -tlnp | grep :3000

# ä¿®æ”¹docker-compose.ymlä¸­çš„ç«¯å£æ˜ å°„
```

## å®‰å…¨å»ºè®®

1. **å®šæœŸæ›´æ–°**ï¼šåŠæ—¶æ›´æ–°Dockeré•œåƒå’Œç³»ç»ŸåŒ…
2. **ç›‘æ§æ—¥å¿—**ï¼šå®šæœŸæ£€æŸ¥åº”ç”¨å’Œç³»ç»Ÿæ—¥å¿—
3. **å¤‡ä»½æ•°æ®**ï¼šè™½ç„¶æ˜¯æ— çŠ¶æ€åº”ç”¨ï¼Œå»ºè®®å¤‡ä»½é…ç½®æ–‡ä»¶
4. **é™åˆ¶è®¿é—®**ï¼šé…ç½®é˜²ç«å¢™è§„åˆ™ï¼Œé™åˆ¶ä¸å¿…è¦çš„è®¿é—®

## æ€§èƒ½ä¼˜åŒ–

1. **èµ„æºé™åˆ¶**ï¼šåœ¨docker-compose.ymlä¸­è®¾ç½®å†…å­˜å’ŒCPUé™åˆ¶
2. **æ—¥å¿—è½®è½¬**ï¼šå·²é…ç½®æ—¥å¿—è½®è½¬ï¼Œé¿å…æ—¥å¿—æ–‡ä»¶è¿‡å¤§
3. **å¥åº·æ£€æŸ¥**ï¼šå·²é…ç½®å¥åº·æ£€æŸ¥ï¼Œè‡ªåŠ¨é‡å¯å¼‚å¸¸å®¹å™¨